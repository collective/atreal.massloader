<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      lang="en"
      metal:use-macro="context/@@standard_macros/page"
      i18n:domain="atreal.massloader">
<head>
</head>

<body>
<div metal:fill-slot="body"
     tal:define="context_state context/@@plone_context_state">
 
<div tal:condition="view/isMassLoaderAware">

<h1 class="documentFirstHeading"
    i18n:translate="ml_import_title">
    Import form for 
    "<span tal:content="context/Title" tal:omit-tag="" i18n:name="title">title</span>"
</h1>

<a href=""
   class="link-parent"
   tal:attributes="href context/absolute_url"
   i18n:translate="go_to_contentrules_assignment_context">
    Return
</a>

<p class="documentDescription"
   i18n:translate="ml_preambule">
    Here you can import a complex zip file, with sub-folders and sub-files. 
</p>

<h2 i18n:translate="ml_rules">Rules</h2>
    <ul>
        <li i18n:translate="ml_rule_size">
        Each file contained in the zip file must fit 
        a maximum size of <tal:block replace="view/getMaxFileSize" i18n:name="size"/> Mb.
        If the size exceeds this limit, the object will not be created.
        </li>
        <li i18n:translate="ml_rule_folder">
        If a folder with a similar name already exists, the old one will be 
        conserved.
        </li>
        <li i18n:translate="ml_rule_object">
        If an object with a similar name already exists, it will be updated with
        the data of the new one.
        </li>
        <li tal:condition="view/isKeywordsEnabled" i18n:translate="ml_rule_keywords">
        Each new object created will have the description and the keywords of this folder.
        </li>
    </ul>
<h2 i18n:translate="ml_advice">Advice</h2>
    <ul>
        <li i18n:translate="ml_advice_time">
        This operation may take a <strong>LOT OF TIME</strong>, depending
        on you internet bandwith, AND of course on the size of your zip file,
        and the formats of the contained files. So be patient and use 
        the import functionality with care.
        </li>
        <li i18n:translate="ml_advice_log">
        All operations performed will be logged and displayed at the end
        of the import. So you will be able to know what occurred with
        each file.
        </li>
        <li i18n:translate="ml_advice_char">
        It's strongly suggested to not have file names with specials characters,
        like [éùàê ...],
        in order to avoid strange file's titles in the portal.
        </li>
    </ul>
    
<form method="post"
      enctype="multipart/form-data"
      tal:attributes="action string:${context/absolute_url}/@@massloader_import/runMassLoader">
<fieldset id="preview" class="block">
    <legend class="collapsibleHeader" i18n:translate="ml_form_choice">
      Choose your <strong>zip file</strong> then submit it  
    </legend>

    <div class="field">
        <input class="noborder"
               type="file"
               name="up_file"
               id="up_file"
               />
    </div>
    
    <div class="field">
        <input class="noborder"
               type="checkbox"
               name="build_report"
               id="build_report"
               tabindex=""
               tal:attributes="tabindex tabindex/next"
               /> 
        <label for="inherit" i18n:translate="ml_form_document">
        Build a report as a Document.
        </label>
        <div class="formHelp" i18n:translate="ml_help_form_document">
            This option will create a Plone Document with the result of the Mass
            Upload in this folder.
            If you don't choose this option, the report will be displayed only once.
        </div>
    </div>

    <input class="context"
           type="submit"
           name="form_submit"
           value="Save"
           i18n:attributes="value label_save"
           tabindex=""
           tal:attributes="tabindex tabindex/next"
           />
    <input class="standalone"
           type="reset"
           name="form.button.cancel"
           value="Cancel"
           i18n:attributes="value label_cancel"
           tabindex=""
           tal:attributes="tabindex tabindex/next"
           />

</fieldset>
</form>
</div>
<div tal:condition="not:view/isMassLoaderAware">
 <tal:redirect content="view/redirectToContext" />
</div> 
</div>
</body>
</html>
